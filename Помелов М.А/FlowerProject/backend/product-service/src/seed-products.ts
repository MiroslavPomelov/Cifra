import { NestFactory } from '@nestjs/core';
import { AppModule } from './app.module';
import { ProductService } from './product/product.service';
import { Product } from './product/entities/product.entity';
import { Repository } from 'typeorm';
import { getRepositoryToken } from '@nestjs/typeorm';

async function seedProducts() {
  const app = await NestFactory.createApplicationContext(AppModule);
  const productService = app.get(ProductService);
  const productRepository = app.get<Repository<Product>>(getRepositoryToken(Product));

  // –ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥
  // px ts-node src/seed-products.ts 
  // npm run seed.

  const products = [
    // –ú–∞–≥–∞–∑–∏–Ω 1 - –¶–≤–µ—Ç–æ—á–Ω—ã–π —Ä–∞–π
    {
      name: '–ë—É–∫–µ—Ç "–ù–µ–∂–Ω–æ—Å—Ç—å"',
      description: '–ù–µ–∂–Ω—ã–π –±—É–∫–µ—Ç –∏–∑ —Ä–æ–∑–æ–≤—ã—Ö —Ä–æ–∑ –∏ –±–µ–ª—ã—Ö —Ç—é–ª—å–ø–∞–Ω–æ–≤, –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—ã–π –≤ –ø–∞—Å—Ç–µ–ª—å–Ω—ã—Ö —Ç–æ–Ω–∞—Ö',
      price: 2500,
      imageUrl: 'üå∏',
      shopId: 1,
    },
    {
      name: '–ö–æ–º–ø–æ–∑–∏—Ü–∏—è "–≠–ª–µ–≥–∞–Ω—Ç–Ω–æ—Å—Ç—å"',
      description: '–≠–ª–µ–≥–∞–Ω—Ç–Ω–∞—è –∫–æ–º–ø–æ–∑–∏—Ü–∏—è –∏–∑ –∫—Ä–∞—Å–Ω—ã—Ö —Ä–æ–∑ –∏ –±–µ–ª—ã—Ö –ª–∏–ª–∏–π –¥–ª—è –æ—Å–æ–±—ã—Ö —Å–ª—É—á–∞–µ–≤',
      price: 3200,
      imageUrl: 'üåπ',
      shopId: 1,
    },
    {
      name: '–ë—É–∫–µ—Ç "–°–æ–ª–Ω–µ—á–Ω–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"',
      description: '–Ø—Ä–∫–∏–π –±—É–∫–µ—Ç –∏–∑ –ø–æ–¥—Å–æ–ª–Ω—É—Ö–æ–≤ –∏ –∂–µ–ª—Ç—ã—Ö —Ä–æ–∑, –ø–æ–¥–Ω–∏–º–∞—é—â–∏–π –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ',
      price: 1800,
      imageUrl: 'üåª',
      shopId: 1,
    },
    {
      name: '–ö–æ–º–ø–æ–∑–∏—Ü–∏—è "–ò–∑—ã—Å–∫–∞–Ω–Ω–æ—Å—Ç—å"',
      description: '–ò–∑—ã—Å–∫–∞–Ω–Ω–∞—è –∫–æ–º–ø–æ–∑–∏—Ü–∏—è –∏–∑ –æ—Ä—Ö–∏–¥–µ–π –∏ –±–µ–ª—ã—Ö —Ä–æ–∑ –≤ —Å—Ç–µ–∫–ª—è–Ω–Ω–æ–π –≤–∞–∑–µ',
      price: 4500,
      imageUrl: 'üå∫',
      shopId: 1,
    },

    // –ú–∞–≥–∞–∑–∏–Ω 2 - –ë—É–∫–µ—Ç-–°–µ—Ä–≤–∏—Å
    {
      name: '–ë—É–∫–µ—Ç "–ö–ª–∞—Å—Å–∏–∫–∞"',
      description: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –±—É–∫–µ—Ç –∏–∑ –∫—Ä–∞—Å–Ω—ã—Ö —Ä–æ–∑, –∏–¥–µ–∞–ª—å–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫ –¥–ª—è –ª—é–±–æ–π –¥–∞–º—ã',
      price: 2800,
      imageUrl: 'üåπ',
      shopId: 2,
    },
    {
      name: '–ö–æ–º–ø–æ–∑–∏—Ü–∏—è "–í–µ—Å–µ–Ω–Ω—è—è —Å–≤–µ–∂–µ—Å—Ç—å"',
      description: '–ù–µ–∂–Ω–∞—è –∫–æ–º–ø–æ–∑–∏—Ü–∏—è –∏–∑ —Ä–æ–∑–æ–≤—ã—Ö –ø–∏–æ–Ω–æ–≤ –∏ –±–µ–ª—ã—Ö —Ä–æ–∑',
      price: 3600,
      imageUrl: 'üå∏',
      shopId: 2,
    },
    {
      name: '–ë—É–∫–µ—Ç "–ü—Ä–∞–∑–¥–Ω–∏–∫"',
      description: '–Ø—Ä–∫–∏–π –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–π –±—É–∫–µ—Ç –∏–∑ —Ä–∞–∑–Ω–æ—Ü–≤–µ—Ç–Ω—ã—Ö —Ç—é–ª—å–ø–∞–Ω–æ–≤',
      price: 2200,
      imageUrl: 'üå∑',
      shopId: 2,
    },
    {
      name: '–ö–æ–º–ø–æ–∑–∏—Ü–∏—è "–≠–∫—Å–∫–ª—é–∑–∏–≤"',
      description: '–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω–∞—è –∫–æ–º–ø–æ–∑–∏—Ü–∏—è –∏–∑ —Ä–µ–¥–∫–∏—Ö –æ—Ä—Ö–∏–¥–µ–π –∏ —Ä–æ–∑',
      price: 5200,
      imageUrl: 'üå∫',
      shopId: 2,
    },

    // –ú–∞–≥–∞–∑–∏–Ω 3 - –†–æ–∑–∞—Ä–∏–π
    {
      name: '–ë—É–∫–µ—Ç "–ö–æ—Ä–æ–ª–µ–≤–∞ —Ä–æ–∑"',
      description: '–†–æ—Å–∫–æ—à–Ω—ã–π –±—É–∫–µ—Ç –∏–∑ 25 –∫—Ä–∞—Å–Ω—ã—Ö —Ä–æ–∑ –ø—Ä–µ–º–∏—É–º-–∫–ª–∞—Å—Å–∞',
      price: 3800,
      imageUrl: 'üåπ',
      shopId: 3,
    },
    {
      name: '–ö–æ–º–ø–æ–∑–∏—Ü–∏—è "–ë–µ–ª–∞—è –Ω–µ–≤–µ—Å—Ç–∞"',
      description: '–≠–ª–µ–≥–∞–Ω—Ç–Ω–∞—è –∫–æ–º–ø–æ–∑–∏—Ü–∏—è –∏–∑ –±–µ–ª—ã—Ö —Ä–æ–∑ –∏ –ª–∏–ª–∏–π –¥–ª—è —Å–≤–∞–¥–µ–±',
      price: 4200,
      imageUrl: 'üåπ',
      shopId: 3,
    },
    {
      name: '–ë—É–∫–µ—Ç "–†–æ–∑–æ–≤—ã–π –∑–∞–∫–∞—Ç"',
      description: '–†–æ–º–∞–Ω—Ç–∏—á–Ω—ã–π –±—É–∫–µ—Ç –∏–∑ —Ä–æ–∑–æ–≤—ã—Ö —Ä–æ–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ—Ç—Ç–µ–Ω–∫–æ–≤',
      price: 2900,
      imageUrl: 'üåπ',
      shopId: 3,
    },
    {
      name: '–ö–æ–º–ø–æ–∑–∏—Ü–∏—è "–ö–æ—Ä–æ–ª–µ–≤—Å–∫–∞—è"',
      description: '–ò–∑—ã—Å–∫–∞–Ω–Ω–∞—è –∫–æ–º–ø–æ–∑–∏—Ü–∏—è –∏–∑ –±–æ—Ä–¥–æ–≤—ã—Ö —Ä–æ–∑ –∏ –æ—Ä—Ö–∏–¥–µ–π',
      price: 4800,
      imageUrl: 'üåπ',
      shopId: 3,
    },

    // –ú–∞–≥–∞–∑–∏–Ω 4 - –í–µ—Å–µ–Ω–Ω–∏–µ —Ü–≤–µ—Ç—ã
    {
      name: '–ë—É–∫–µ—Ç "–í–µ—Å–µ–Ω–Ω—è—è —Ä–∞–¥–æ—Å—Ç—å"',
      description: '–°–≤–µ–∂–∏–π –±—É–∫–µ—Ç –∏–∑ —Ç—é–ª—å–ø–∞–Ω–æ–≤ –∏ –Ω–∞—Ä—Ü–∏—Å—Å–æ–≤, —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É—é—â–∏–π –≤–µ—Å–Ω—É',
      price: 1600,
      imageUrl: 'üå∑',
      shopId: 4,
    },
    {
      name: '–ö–æ–º–ø–æ–∑–∏—Ü–∏—è "–ü—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ"',
      description: '–ù–µ–∂–Ω–∞—è –∫–æ–º–ø–æ–∑–∏—Ü–∏—è –∏–∑ –±–µ–ª—ã—Ö —Ç—é–ª—å–ø–∞–Ω–æ–≤ –∏ –≥–∏–∞—Ü–∏–Ω—Ç–æ–≤',
      price: 2100,
      imageUrl: 'üå∑',
      shopId: 4,
    },
    {
      name: '–ë—É–∫–µ—Ç "–°–æ–ª–Ω–µ—á–Ω—ã–µ –ª—É—á–∏"',
      description: '–Ø—Ä–∫–∏–π –±—É–∫–µ—Ç –∏–∑ –∂–µ–ª—Ç—ã—Ö –Ω–∞—Ä—Ü–∏—Å—Å–æ–≤ –∏ —Ç—é–ª—å–ø–∞–Ω–æ–≤',
      price: 1800,
      imageUrl: 'üåª',
      shopId: 4,
    },
    {
      name: '–ö–æ–º–ø–æ–∑–∏—Ü–∏—è "–í–µ—Å–µ–Ω–Ω—è—è —Å–≤–µ–∂–µ—Å—Ç—å"',
      description: '–°–≤–µ–∂–∞—è –∫–æ–º–ø–æ–∑–∏—Ü–∏—è –∏–∑ —Ä–∞–∑–Ω–æ—Ü–≤–µ—Ç–Ω—ã—Ö —Ç—é–ª—å–ø–∞–Ω–æ–≤',
      price: 2400,
      imageUrl: 'üå∑',
      shopId: 4,
    },

    // –ú–∞–≥–∞–∑–∏–Ω 5 - –≠–∫–∑–æ—Ç–∏–∫–∞
    {
      name: '–ö–æ–º–ø–æ–∑–∏—Ü–∏—è "–¢—Ä–æ–ø–∏—á–µ—Å–∫–∏–π —Ä–∞–π"',
      description: '–≠–∫–∑–æ—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–º–ø–æ–∑–∏—Ü–∏—è –∏–∑ –æ—Ä—Ö–∏–¥–µ–π –∏ –∞–Ω—Ç—É—Ä–∏—É–º–æ–≤',
      price: 3800,
      imageUrl: 'üå∫',
      shopId: 5,
    },
    {
      name: '–ë—É–∫–µ—Ç "–≠–∫–∑–æ—Ç–∏–∫–∞"',
      description: '–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –±—É–∫–µ—Ç –∏–∑ —Ä–µ–¥–∫–∏—Ö —Ç—Ä–æ–ø–∏—á–µ—Å–∫–∏—Ö —Ü–≤–µ—Ç–æ–≤',
      price: 4200,
      imageUrl: 'üå∫',
      shopId: 5,
    },
    {
      name: '–ö–æ–º–ø–æ–∑–∏—Ü–∏—è "–û—Å—Ç—Ä–æ–≤ –º–µ—á—Ç—ã"',
      description: '–≠–∫–∑–æ—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–º–ø–æ–∑–∏—Ü–∏—è –∏–∑ –æ—Ä—Ö–∏–¥–µ–π –∏ –±—Ä–æ–º–µ–ª–∏–µ–≤—ã—Ö',
      price: 3600,
      imageUrl: 'üå∫',
      shopId: 5,
    },
    {
      name: '–ë—É–∫–µ—Ç "–¢—Ä–æ–ø–∏—á–µ—Å–∫–∞—è –Ω–æ—á—å"',
      description: '–ó–∞–≥–∞–¥–æ—á–Ω–∞—è –∫–æ–º–ø–æ–∑–∏—Ü–∏—è –∏–∑ —Ç–µ–º–Ω—ã—Ö –æ—Ä—Ö–∏–¥–µ–π –∏ —ç–∫–∑–æ—Ç–∏—á–µ—Å–∫–∏—Ö —Ü–≤–µ—Ç–æ–≤',
      price: 4500,
      imageUrl: 'üå∫',
      shopId: 5,
    },
  ];

  console.log('–ù–∞—á–∏–Ω–∞–µ–º –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤...');

  for (const productData of products) {
    try {
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ø—Ä–æ–¥—É–∫—Ç —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º –≤ —ç—Ç–æ–º –º–∞–≥–∞–∑–∏–Ω–µ
      const existing = await productRepository.findOne({
        where: {
          name: productData.name,
          shopId: productData.shopId
        }
      });

      if (existing) {
        console.log(`‚è≠Ô∏è –ü—Ä–æ–¥—É–∫—Ç "${productData.name}" —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –º–∞–≥–∞–∑–∏–Ω–µ ${productData.shopId}, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º`);
        continue;
      }

      const product = await productService.create(productData, productData.shopId);
      console.log(`‚úÖ –ü—Ä–æ–¥—É–∫—Ç "${product.name}" —Å–æ–∑–¥–∞–Ω —Å ID: ${product.id}`);
    } catch (error) {
      console.error(`‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–∞ "${productData.name}":`, error.message);
    }
  }

  console.log('–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!');
  await app.close();
}

seedProducts().catch(console.error);
